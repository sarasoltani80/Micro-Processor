#include <avr/io.h>#include <avr/interrupt.h>#include <util/delay.h>#include <string.h>#include <stdio.h>#define LCD_DPRT PORTB // LCD commands port#define LCD_DDDR DDRB#define LCD_DPIN PINB#define LCD_CPRT PORTA // LCD commands port#define LCD_CDDR DDRA#define LCD_CPIN PINA#define LCD_RS 7#define LCD_RW 6#define LCD_EN 5volatile unsigned int interrupt_count;void lcdCommand(unsigned char cmnd){	LCD_DPRT = cmnd;	LCD_CPRT &= ~ (1<<LCD_RS);	LCD_CPRT &= ~ (1<<LCD_RW);	LCD_CPRT |= (1<<LCD_EN);	_delay_us(1);	LCD_CPRT &= ~ (1<<LCD_EN);	_delay_us(100);}void lcdData(unsigned char data){	LCD_DPRT = data;	LCD_CPRT |= (1<<LCD_RS);	LCD_CPRT &= ~ (1<<LCD_RW);	LCD_CPRT |= (1<<LCD_EN);	_delay_us(1);	LCD_CPRT &= ~ (1<<LCD_EN);	_delay_us(100);}void lcd_init(){	LCD_DDDR = 0xFF;	LCD_CDDR = 0xFF;		LCD_CPRT &= ~ (1<<LCD_EN);	_delay_us(2000);	lcdCommand(0x38);	lcdCommand(0x0E);	lcdCommand(0x01);	_delay_us(2000);	lcdCommand(0x06);}void lcd_gotoxy(unsigned char x, unsigned char y){	unsigned char firstCharAdr[] = {0x80, 0xC0, 0x94, 0xD4};	lcdCommand(firstCharAdr[y-1] + x - 1);	_delay_us(100);}void lcd_print(char *str){	unsigned char i = 0;	while(str[i] != 0){		lcdData(str[i]);		i++;	}}int main(void){	lcd_init();	lcd_gotoxy(1,1);	lcd_print("in main");	_delay_ms(1000);		interrupt_count = 0;		DDRC |= 0x03; //DDRB.0 and DDRB.1 output		TCNT0 = -160;	TCCR0 = 0x01;		TCNT1H = (-640)>>8;	TCNT1L = (-640);	TCCR1A = 0x00;	TCCR1B = 0x01;		TIMSK = (1<<TOIE0)|(1<<TOIE1);	sei();	while (1){		lcd_init();		lcd_gotoxy(1,1);		lcd_print("in main 2");		_delay_ms(1000);	}	return 0;}ISR(TIMER0_OVF_vect){	interrupt_count++;	char temp[2];	sprintf(temp,"%d", interrupt_count);	lcd_init();	lcd_gotoxy(1,2);	lcd_print(temp);	/*lcd_init();	lcd_gotoxy(1,1);	lcd_print("in t0_ov");	lcd_gotoxy(1, 2);	lcd_print( strcat("handler l", temp) );*/	_delay_ms(1000);		TCNT0 = -160;	PORTC ^= 0x01; //toggle portb.0		/*lcd_gotoxy(1,1);	lcd_print("end of t0_ov");	lcd_gotoxy(1, 2);	lcd_print("handler");*/		interrupt_count--;}ISR(TIMER1_OVF_vect){	interrupt_count++;	char temp[2];	sprintf(temp,"%d", interrupt_count);	lcd_init();	lcd_gotoxy(1,2);	lcd_print(temp);		/*lcd_init();	lcd_gotoxy(1,1);	lcd_print("in t1_ov");	lcd_gotoxy(1, 2);	lcd_print( strcat("handler l", temp) );*/	_delay_ms(1000);		if(interrupt_count != 3)		sei();		TCNT1H = (-640)>>8;	TCNT1L = (-640);	PORTC ^= 0x02; //toggle protb.1		/*lcd_gotoxy(1,1);	lcd_print("end of in t1_ov");	lcd_gotoxy(1, 2);	lcd_print("handler");*/	interrupt_count--;}